!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("lodash/partial"),require("react-motion"),require("@nivo/recompose"),require("@nivo/core"),require("@nivo/legends"),require("prop-types"),require("@nivo/colors"),require("react/jsx-runtime"),require("lodash/range"),require("@nivo/tooltip")):"function"==typeof define&&define.amd?define(["exports","react","lodash/partial","react-motion","@nivo/recompose","@nivo/core","@nivo/legends","prop-types","@nivo/colors","react/jsx-runtime","lodash/range","@nivo/tooltip"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).nivo=e.nivo||{},e.React,e["lodash/partial"],e.ReactMotion,e.nivo,e.nivo,e.nivo,e.PropTypes,e.nivo,e["react/jsx-runtime"],e["lodash/range"],e.nivo)}(this,(function(e,t,o,r,i,n,a,l,u,d,s,f){"use strict";function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var p=c(o),h=c(l),m=c(s);function v(){return v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},v.apply(this,arguments)}function y(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,g(e,t)}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}var C=function(e){var t=e.position,o=e.size,r=e.x,i=e.y,n=e.color,a=e.fill,l=e.opacity,u=e.borderWidth,s=e.borderColor,f=e.data,c=e.onHover,p=e.onLeave,h=e.onClick;return d.jsx("rect",{width:o,height:o,x:r,y:i,fill:a||n,strokeWidth:u,stroke:s,opacity:l,onMouseEnter:c,onMouseMove:c,onMouseLeave:p,onClick:function(e){h({position:t,color:n,x:r,y:i,data:f},e)}})};C.propTypes={position:h.default.number.isRequired,size:h.default.number.isRequired,x:h.default.number.isRequired,y:h.default.number.isRequired,color:h.default.string.isRequired,fill:h.default.string,opacity:h.default.number.isRequired,borderWidth:h.default.number.isRequired,borderColor:h.default.string.isRequired,data:h.default.object.isRequired,onHover:h.default.func.isRequired,onLeave:h.default.func.isRequired,onClick:h.default.func.isRequired},C.defaultProps={data:{}},C.displayName="WaffleCell";var x=i.pure(C),b=function(e){var t=e.position,o=e.size,r=e.x,i=e.y,n=e.color,a=e.opacity,l=e.borderWidth,u=e.borderColor,s=e.data,f=e.onHover,c=e.onLeave,p=e.onClick;return d.jsx("div",{style:{position:"absolute",top:i,left:r,width:o,height:o,background:n,opacity:a,boxSizing:"content-box",borderStyle:"solid",borderWidth:l+"px",borderColor:u},onMouseEnter:f,onMouseMove:f,onMouseLeave:c,onClick:function(e){p({position:t,color:n,x:r,y:i,data:s},e)}})};b.propTypes={position:h.default.number.isRequired,size:h.default.number.isRequired,x:h.default.number.isRequired,y:h.default.number.isRequired,color:h.default.string.isRequired,opacity:h.default.number.isRequired,borderWidth:h.default.number.isRequired,borderColor:h.default.string.isRequired,data:h.default.object.isRequired,onHover:h.default.func.isRequired,onLeave:h.default.func.isRequired,onClick:h.default.func.isRequired},b.defaultProps={data:{}},b.displayName="WaffleCellHtml";var R=i.pure(b),q={total:h.default.number.isRequired,data:h.default.arrayOf(h.default.shape({id:h.default.oneOfType([h.default.string,h.default.number]).isRequired,label:h.default.oneOfType([h.default.string,h.default.number]).isRequired,value:h.default.number.isRequired})).isRequired,hiddenIds:h.default.arrayOf(h.default.oneOfType([h.default.string,h.default.number])).isRequired,rows:h.default.number.isRequired,columns:h.default.number.isRequired,fillDirection:h.default.oneOf(["top","right","bottom","left"]).isRequired,padding:h.default.number.isRequired,colors:u.ordinalColorsPropType.isRequired,emptyColor:h.default.string.isRequired,emptyOpacity:h.default.number.isRequired,borderWidth:h.default.number.isRequired,borderColor:u.inheritedColorPropType.isRequired,getBorderColor:h.default.func.isRequired,isInteractive:h.default.bool,tooltipFormat:h.default.oneOfType([h.default.func,h.default.string]),tooltip:h.default.func,cellSize:h.default.number.isRequired,cells:h.default.array.isRequired,origin:h.default.shape({x:h.default.number.isRequired,y:h.default.number.isRequired}).isRequired},w=v({},q,{cellComponent:h.default.func.isRequired,role:h.default.string.isRequired},n.defsPropTypes,{legends:h.default.arrayOf(h.default.shape(a.LegendPropShape)).isRequired}),W=v({},q,{cellComponent:h.default.func.isRequired}),j=v({},q,{pixelRatio:h.default.number.isRequired,legends:h.default.arrayOf(h.default.shape(a.LegendPropShape)).isRequired}),P={hiddenIds:[],fillDirection:"bottom",padding:1,colors:{scheme:"nivo"},emptyColor:"#cccccc",emptyOpacity:1,borderWidth:0,borderColor:{from:"color",modifiers:[["darker",1]]},defs:[],fill:[],isInteractive:!0,onClick:n.noop},T=v({},P,{cellComponent:x,role:"img",defs:[],fill:[],legends:[]}),k=v({},P,{cellComponent:R}),D=v({},P,{legends:[],pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),M=Object.freeze({__proto__:null,WafflePropTypes:w,WaffleHtmlPropTypes:W,WaffleCanvasPropTypes:j,WaffleDefaultProps:T,WaffleHtmlDefaultProps:k,WaffleCanvasDefaultProps:D}),O=function(e,t,o,r,i,n){var a=function(e,t,o,r,i){var n=(e-(r-1)*i)/r,a=(t-(o-1)*i)/o;return Math.min(n,a)}(e,t,o,r,n),l=[];switch(i){case"top":m.default(o).forEach((function(e){m.default(r).forEach((function(t){l.push({position:e*r+t,row:e,column:t,x:t*(a+n),y:e*(a+n)})}))}));break;case"bottom":m.default(o-1,-1).forEach((function(e){m.default(r).forEach((function(t){l.push({position:e*r+t,row:e,column:t,x:t*(a+n),y:e*(a+n)})}))}));break;case"left":m.default(r).forEach((function(e){m.default(o).forEach((function(t){l.push({position:t*r+e,row:t,column:e,x:e*(a+n),y:t*(a+n)})}))}));break;case"right":m.default(r-1,-1).forEach((function(e){m.default(o-1,-1).forEach((function(t){l.push({position:t*r+e,row:t,column:e,x:e*(a+n),y:t*(a+n)})}))}));break;default:throw new Error("Invalid fill direction provided: "+i)}return{cells:l,cellSize:a,origin:{x:(e-(a*r+n*(r-1)))/2,y:(t-(a*o+n*(o-1)))/2}}},H=function(e,t){var o=e.map((function(e){return v({},e)}));return t.forEach((function(e){m.default(e.startAt,e.endAt).forEach((function(t){var r=o[t];void 0!==r&&(r.data=e,r.groupIndex=e.groupIndex,r.color=e.color)}))})),o},A=[n.withDimensions(),n.withTheme(),n.withMotion(),i.withPropsOnChange(["colors"],(function(e){var t=e.colors;return{getColor:u.getOrdinalColorScale(t,"id")}})),i.withPropsOnChange(["borderColor","theme"],(function(e){var t=e.borderColor,o=e.theme;return{getBorderColor:u.getInheritedColorGenerator(t,o)}})),i.withState("currentCell","setCurrentCell",null),i.withPropsOnChange(["rows","columns","total"],(function(e){var t=e.rows,o=e.columns;return{unit:e.total/(t*o)}})),i.withPropsOnChange(["width","height","rows","columns","fillDirection","padding"],(function(e){var t=e.width,o=e.height,r=e.rows,i=e.columns,n=e.fillDirection,a=e.padding;return O(t,o,r,i,n,a)})),i.withPropsOnChange(["data","unit","getColor","hiddenIds"],(function(e){var t=e.data,o=e.unit,r=e.getColor,i=e.hiddenIds,n=0;return{computedData:t.map((function(e,t){if(!i.includes(e.id)){var a=v({},e,{groupIndex:t,startAt:n,endAt:n+Math.round(e.value/o),color:r(e)});return n=a.endAt,a}return v({},e,{groupIndex:t,startAt:n,endAt:n,color:r(e)})}))}})),i.withPropsOnChange(["computedData"],(function(e){return{legendData:e.computedData.map((function(e){return{id:e.id,label:e.id,color:e.color,fill:e.fill}}))}}))],E=function(e){var t=M[e.displayName+"DefaultProps"];switch(e.displayName){case"Waffle":return i.compose.apply(void 0,[i.defaultProps(t)].concat(A,[n.withMotion(),i.withPropsOnChange(["computedData","defs","fill"],(function(e){var t=e.computedData,o=e.defs,r=e.fill;return{defs:n.bindDefs(o,t,r,{targetKey:"fill"})}})),i.pure]))(e);case"WaffleHtml":return i.compose.apply(void 0,[i.defaultProps(t)].concat(A,[n.withMotion(),i.pure]))(e);case"WaffleCanvas":return i.compose.apply(void 0,[i.defaultProps(t)].concat(A,[i.pure]))(e)}return e},I=function(e){var t=e.position,o=e.row,r=e.column,i=e.color,n=e.data,a=e.theme,l=e.tooltipFormat,u=e.tooltip;return d.jsx(f.BasicTooltip,{id:n.label,value:n.value,enableChip:!0,color:i,theme:a,format:l,renderContent:"function"==typeof u?u.bind(null,v({position:t,row:o,column:r,color:i},n)):null})};I.displayName="WaffleCellTooltip",I.propTypes={position:h.default.number.isRequired,row:h.default.number.isRequired,column:h.default.number.isRequired,color:h.default.string.isRequired,data:h.default.object.isRequired,theme:h.default.object.isRequired,tooltipFormat:h.default.oneOfType([h.default.func,h.default.string]),tooltip:h.default.func};var L=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).handleCellHover=function(e,o,r){var i=t.props,n=i.setCurrentCell,a=i.theme,l=i.tooltipFormat,u=i.tooltip;n(o),o.data&&e(d.jsx(I,{position:o.position,row:o.row,column:o.column,color:o.color,data:o.data,theme:a,tooltipFormat:l,tooltip:u}),r)},t.handleCellLeave=function(e){t.props.setCurrentCell(null),e()},t}return y(o,e),o.prototype.render=function(){var e=this,o=this.props;o.hiddenIds;var i=o.margin,l=o.width,u=o.height,s=o.outerWidth,f=o.outerHeight,c=o.cellComponent,h=o.emptyColor,m=o.emptyOpacity,y=o.borderWidth,g=o.getBorderColor,C=o.theme,x=o.defs,b=o.animate,R=o.motionStiffness,q=o.motionDamping,w=o.isInteractive,W=o.onClick,j=o.cells,P=o.cellSize,T=o.origin,k=o.computedData,D=o.legendData,M=o.legends,O=o.role;return j.forEach((function(e){e.color=h})),d.jsx(n.LegacyContainer,{isInteractive:w,theme:C,animate:b,motionDamping:q,motionStiffness:R,children:function(o){var h,w=o.showTooltip,A=o.hideTooltip,E=p.default(e.handleCellHover,w),I=p.default(e.handleCellLeave,A);if(!0===b){var L={stiffness:R,damping:q};h=d.jsx(r.TransitionMotion,{styles:k.map((function(e){return{key:e.id,data:e,style:{startAt:r.spring(e.startAt,L),endAt:r.spring(e.endAt,L)}}})),children:function(e){var o=H(j,e.map((function(e){return v({},e.data,{startAt:Math.round(e.style.startAt),endAt:Math.round(e.style.endAt)})})));return d.jsx(t.Fragment,{children:o.map((function(e){return t.createElement(c,{key:e.position,position:e.position,size:P,x:e.x,y:e.y,color:e.color,fill:e.data&&e.data.fill,opacity:e.data?1:m,borderWidth:y,borderColor:g(e),data:e.data,onHover:p.default(E,e),onLeave:I,onClick:W})}))})}})}else{var S=H(j,k);h=d.jsx(t.Fragment,{children:S.map((function(e){return t.createElement(c,{key:e.position,position:e.position,size:P,x:e.x,y:e.y,color:e.color,fill:e.data&&e.data.fill,opacity:e.data?1:m,borderWidth:y,borderColor:g(e),data:e.data,onHover:p.default(E,e),onLeave:I,onClick:W})}))})}return d.jsxs(n.SvgWrapper,{width:s,height:f,margin:i,defs:x,theme:C,role:O,children:[d.jsx("g",{transform:"translate("+T.x+", "+T.y+")",children:h}),M.map((function(e,t){return d.jsx(a.BoxLegendSvg,v({},e,{containerWidth:l,containerHeight:u,data:D,theme:C}),t)}))]})}})},o}(t.Component);L.propTypes=w,L.displayName="Waffle";var S=i.setDisplayName(L.displayName)(E(L)),z=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).handleCellHover=function(e,o,r){var i=t.props,n=i.setCurrentCell,a=i.theme,l=i.tooltipFormat,u=i.tooltip;n(o),o.data&&e(d.jsx(I,{position:o.position,row:o.row,column:o.column,color:o.color,data:o.data,theme:a,tooltipFormat:l,tooltip:u}),r)},t.handleCellLeave=function(e){t.props.setCurrentCell(null),e()},t}return y(o,e),o.prototype.render=function(){var e=this,o=this.props,i=o.margin,a=o.outerWidth,l=o.outerHeight,u=o.cellComponent,s=o.emptyColor,f=o.emptyOpacity,c=o.borderWidth,h=o.getBorderColor,m=o.theme,y=o.animate,g=o.motionStiffness,C=o.motionDamping,x=o.isInteractive,b=o.onClick,R=o.cells,q=o.cellSize,w=o.origin,W=o.computedData;return R.forEach((function(e){e.color=s})),d.jsx(n.LegacyContainer,{isInteractive:x,theme:m,animate:y,motionDamping:C,motionStiffness:g,children:function(o){var n,s=o.showTooltip,m=o.hideTooltip,x=p.default(e.handleCellHover,s),j=p.default(e.handleCellLeave,m);if(!0===y){var P={stiffness:g,damping:C};n=d.jsx(r.TransitionMotion,{styles:W.map((function(e){return{key:e.id,data:e,style:{startAt:r.spring(e.startAt,P),endAt:r.spring(e.endAt,P)}}})),children:function(e){var o=H(R,e.map((function(e){return v({},e.data,{startAt:Math.round(e.style.startAt),endAt:Math.round(e.style.endAt)})})));return d.jsx(t.Fragment,{children:o.map((function(e){return t.createElement(u,{key:e.position,position:e.position,size:q,x:e.x,y:e.y,color:e.color,fill:e.data&&e.data.fill,opacity:e.data?1:f,borderWidth:c,borderColor:h(e),data:e.data,onHover:p.default(x,e),onLeave:j,onClick:b})}))})}})}else{var T=H(R,W);n=d.jsx(t.Fragment,{children:T.map((function(e){return t.createElement(u,{key:e.position,position:e.position,size:q,x:e.x,y:e.y,color:e.color,fill:e.data&&e.data.fill,opacity:e.data?1:f,borderWidth:c,borderColor:h(e),data:e.data,onHover:p.default(x,e),onLeave:j,onClick:b})}))})}return d.jsx("div",{style:{position:"relative",width:a,height:l},children:d.jsx("div",{style:{position:"absolute",top:i.top+w.y,left:i.left+w.x},children:n})})}})},o}(t.Component);z.propTypes=W,z.displayName="WaffleHtml";var N=i.setDisplayName(z.displayName)(E(z)),F=function(e,t,o,r,i,a){return e.find((function(e){return n.isCursorInRect(e.x+o.x+r.left,e.y+o.y+r.top,t,t,i,a)}))},_=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).handleMouseHover=function(e,o){return function(r){var i=t.props,a=i.isInteractive,l=i.margin,u=i.theme,s=i.cells,f=i.cellSize,c=i.origin,p=i.tooltipFormat,h=i.tooltip;if(a&&s){var m=n.getRelativeCursor(t.surface,r),v=m[0],y=m[1],g=F(s,f,c,l,v,y);void 0!==g&&g.data?e(d.jsx(I,{position:g.position,row:g.row,column:g.column,color:g.color,data:g.data,theme:u,tooltipFormat:p,tooltip:h}),r):o()}}},t.handleMouseLeave=function(e){return function(){!0===t.props.isInteractive&&e()}},t.handleClick=function(e){var o=t.props,r=o.isInteractive,i=o.margin,a=o.onClick,l=o.cells,u=o.cellSize,d=o.origin;if(r&&l){var s=n.getRelativeCursor(t.surface,e),f=s[0],c=s[1],p=F(l,u,d,i,f,c);void 0!==p&&a(p,e)}},t}y(t,e);var o=t.prototype;return o.componentDidMount=function(){this.ctx=this.surface.getContext("2d"),this.draw(this.props)},o.componentDidUpdate=function(){this.ctx=this.surface.getContext("2d"),this.draw(this.props)},o.draw=function(e){var t=this,o=e.pixelRatio,r=e.margin,i=e.width,n=e.height,l=e.outerWidth,u=e.outerHeight,d=e.getColor,s=e.emptyColor,f=e.emptyOpacity,c=e.borderWidth,p=e.getBorderColor,h=e.cells,y=e.cellSize,g=e.origin,C=e.computedData,x=e.legendData,b=e.legends,R=e.theme;this.surface.width=l*o,this.surface.height=u*o,this.ctx.scale(o,o),this.ctx.fillStyle=R.background,this.ctx.fillRect(0,0,l,u),this.ctx.translate(r.left,r.top),h.forEach((function(e){e.color=s})),C.forEach((function(e){m.default(e.startAt,e.endAt).forEach((function(t){var o=h[t];void 0!==o&&(o.data=e,o.groupIndex=e.groupIndex,o.color=d(e))}))})),h.forEach((function(e){t.ctx.save(),t.ctx.globalAlpha=e.data?1:f,t.ctx.fillStyle=e.color,t.ctx.fillRect(e.x+g.x,e.y+g.y,y,y),c>0&&(t.ctx.strokeStyle=p(e),t.ctx.lineWidth=c,t.ctx.strokeRect(e.x+g.x,e.y+g.y,y,y)),t.ctx.restore()})),b.forEach((function(e){a.renderLegendToCanvas(t.ctx,v({},e,{data:x,containerWidth:i,containerHeight:n,theme:R}))}))},o.render=function(){var e=this,t=this.props,o=t.outerWidth,r=t.outerHeight,i=t.pixelRatio,a=t.isInteractive,l=t.theme;return d.jsx(n.LegacyContainer,{isInteractive:a,theme:l,animate:!1,children:function(t){var n=t.showTooltip,a=t.hideTooltip;return d.jsx("canvas",{ref:function(t){e.surface=t},width:o*i,height:r*i,style:{width:o,height:r},onMouseEnter:e.handleMouseHover(n,a),onMouseMove:e.handleMouseHover(n,a),onMouseLeave:e.handleMouseLeave(a),onClick:e.handleClick})}})},t}(t.Component);_.propTypes=j,_.displayName="WaffleCanvas";var B=i.setDisplayName(_.displayName)(E(_));e.ResponsiveWaffle=function(e){return d.jsx(n.ResponsiveWrapper,{children:function(t){var o=t.width,r=t.height;return d.jsx(S,v({width:o,height:r},e))}})},e.ResponsiveWaffleCanvas=function(e){return d.jsx(n.ResponsiveWrapper,{children:function(t){var o=t.width,r=t.height;return d.jsx(B,v({width:o,height:r},e))}})},e.ResponsiveWaffleHtml=function(e){return d.jsx(n.ResponsiveWrapper,{children:function(t){var o=t.width,r=t.height;return d.jsx(N,v({width:o,height:r},e))}})},e.Waffle=S,e.WaffleCanvas=B,e.WaffleCanvasDefaultProps=D,e.WaffleCanvasPropTypes=j,e.WaffleDefaultProps=T,e.WaffleHtml=N,e.WaffleHtmlDefaultProps=k,e.WaffleHtmlPropTypes=W,e.WafflePropTypes=w,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=nivo-waffle.umd.js.map
